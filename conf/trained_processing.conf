########## Bayesian Training ##########

make_bayes_training_data:
{
	module = "chain";
	chain = (
		"main_bayes_train_creator",
		"two_bayes_train_creator"
	);
};

main_bayes_train_creator:
{
	module = "bayesian_training_data_creator";
	filename = "data/main_bayes_train.dat";
	#words = "added_normalized_words";
	words = "added_normalized_noquote_words";
	isvandprop = "isvandalism";
};

two_bayes_train_creator:
{
	module = "bayesian_training_data_creator";
	filename = "data/two_bayes_train.dat";
	#words = "added_normalized_2words";
	words = "added_normalized_noquote_2words";
	isvandprop = "isvandalism";
};


########## ANN Inputs and Training ##########

make_ann_training_data:
{
	module = "chain";
	chain = (
		"run_bayes",
		"ann_input_expressions",
		"main_ann_inputs",
		"main_ann_training_outputs",
		"main_ann_train_creator"
	);
};

ann_input_expressions:
{
	module = "expression_eval";
	result_type = "float";
	expressions:
	{
@include "conf/ann_input_expressions.conf"
	};
};

main_ann_inputs:
{
	module = "float_set_creator";
	output = "main_ann_inputs";
	clip_low = 0.0;
	clip_high = 1.0;
	properties:
	(
@include "conf/ann_input_list.conf"
	);
};

main_ann_training_outputs:
{
	module = "float_set_creator";
	output = "main_ann_outputs";
	clip_low = 0.0;
	clip_high = 1.0;
	properties:
	(
		"isvandalism"
	);
};

main_ann_train_creator:
{
	module = "write_ann_training_data";
	input_set = "main_ann_inputs";
	output_set = "main_ann_outputs";
	filename = "data/main_ann_train.dat";
};


########## Bayesian Running ##########

run_bayes:
{
	module = "chain";
	chain = (
		"main_bayes_scorer",
		"prev_bayes_scorer",
		"two_bayes_scorer",
		"raw_bayes_scorer"
	);
};

main_bayes_scorer:
{
	module = "bayesian_scorer";
	dbfile = "data/bayes.db";
	#input = "added_normalized_words";
	input = "added_normalized_noquote_words";
	output = "main_bayes_score";
	numwords_out = "main_bayes_nwords";
	min_edits = 5;
	num_words = 20;
	min_word_high_score = 0.85;
	max_word_low_score = 0.4;
	probability_ranges = {
		bayes_prob_range_high = (0.94, 1.0);
		bayes_prob_range_mid = (0.88, 0.94);
		bayes_prob_range_low = (0.0, 0.10);
	};
};

raw_bayes_scorer:
{
	module = "bayesian_scorer";
	dbfile = "data/bayes.db";
	input = "added_normalized_words";
	#input = "added_normalized_noquote_words";
	output = "raw_bayes_score";
	numwords_out = "raw_bayes_nwords";
	min_edits = 5;
	num_words = 20;
};

prev_bayes_scorer:
{
	module = "bayesian_scorer";
	dbfile = "data/bayes.db";
	#input = "previous_normalized_words";
	input = "previous_normalized_noquote_words";
	output = "previous_bayes_score";
	numwords_out = "previous_bayes_nwords";
	min_edits = 5;
	num_words = 20;
};

two_bayes_scorer:
{
	module = "bayesian_scorer";
	dbfile = "data/two_bayes.db";
	#input = "added_normalized_2words";
	input = "added_normalized_noquote_2words";
	output = "two_bayes_score";
	numwords_out = "two_bayes_nwords";
	min_edits = 5;
	num_words = 20;
	min_word_high_score = 0.85;
	max_word_low_score = 0.4;
};


########## ANN Running ##########

run_main_ann:
{
	module = "chain";
	chain = (
		"run_bayes",
		"ann_input_expressions",
		"main_ann_inputs",
		"main_ann_runner",
		"main_ann_scorer"
	);
};

main_ann_runner:
{
	module = "run_ann";
	input_set = "main_ann_inputs";
	output_set = "main_ann_outputs";
	ann_file = "data/main_ann.fann";
};

main_ann_scorer:
{
	module = "expression_eval";
	result_type = "float";
	expressions: { main_ann_score = "main_ann_outputs_0"; };
};


